<!doctype html><html lang=en><head><title>Debugger Setup with GDB + OpenOCD in Visual Studio Code</title>
<meta property="og:image" content="https://justinmklam.com//posts/2017/10/vscode-debugger-setup/debugger.png"><meta property="og:type" content="blog"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Because this editor is awesome and I want to use it for everything."><meta name=author content="Justin Lam"><link rel=stylesheet href=https://justinmklam.com/css/syntax.min.css media=screen><link rel=stylesheet href=https://justinmklam.com/css/syntax-dark.min.css media="screen and (prefers-color-scheme: dark)"><link rel=stylesheet href=https://justinmklam.com/css/styles.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-85178257-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-85178257-1")</script></head><body><div class="navbar row"><div><span class=navbar-brand>Justin Lam</span></div><div class=navbar-links><a href=/>Blog</a>
<a href=/projects/>Projects</a>
<a href=/about/>About</a>
<a href=/contact/>Contact</a></div></div><div><div class=single-content><h2 data-toc-skip class=blog-title>Debugger Setup with GDB + OpenOCD in Visual Studio Code</h2><p class=blog-title-metadata>Posted on October 29, 2017
&nbsp;&#183;&nbsp;2 min read
&nbsp;&#183;&nbsp;
<span class=disqus-comment-count data-disqus-url=https://justinmklam.com/posts/2017/10/vscode-debugger-setup/#disqus_thread>0 comments</span>
&nbsp;&#183;&nbsp;
<a class=blog-tag href=/tags/programming>#programming&nbsp;</a>
<a class=blog-tag href=/tags/embedded>#embedded&nbsp;</a></p><a href=/posts/2017/10/vscode-debugger-setup/debugger.png><img class="img-content img-content-header" src=/posts/2017/10/vscode-debugger-setup/debugger.png></a><details class=toc><summary>&nbsp;Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#configuring-vs-code>Configuring VS Code</a></li><li><a href=#starting-a-debug-session>Starting a Debug Session</a></li><li><a href=#troubleshooting>Troubleshooting</a></li></ul></nav></summary></details><div class="blog-content page-content"><p><a href=https://code.visualstudio.com/>Visual Studio Code&rsquo;s</a> combination of functionality, customizability, and aesthetics makes it one of my favourite code editors. As such, I was set on making it work with embedded development since I was getting started with the STM32 line of microcontrollers. I was following the steps outlined in <a href=https://leanpub.com/mastering-stm32>Mastering STM32</a> by Carmine Noviello (which is an excellent resource) until it said to use Eclipse, because life&rsquo;s too short to use software with unnecessary bloat. Enter VS Code and someone wanting to use the latest and greatest in code editors.</p><p>The only thing that was keeping me away was the lack of out-of-the-box debugging compatibility. Fortunately, with VS Code&rsquo;s debugging capability and my sunk-cost pain of figuring this out, getting this workflow going is fairly straightforward!</p><p><strong>Prerequisites</strong></p><ul><li><a href=https://launchpad.net/gcc-arm-embedded>GCC ARM Embedded Tools</a></li><li><a href=https://gnu-mcu-eclipse.github.io/windows-build-tools/>GCC ARM Build Tools</a></li><li><a href=http://openocd.org/>OpenOCD</a></li><li><a href=http://www.st.com/en/development-tools/stsw-link004.html>STM32 ST-LINK Utility</a></li></ul><p><strong>Optional</strong></p><ul><li><a href=http://platformio.org/>STM32CubeMX</a> - For setting up projects. Now making <a href=https://hackaday.com/2017/07/15/stm32cubemx-makes-makefiles/>makefiles</a>!</li><li><a href=http://platformio.org/>PlatformIO</a> - A one-stop shop for setting up common hardware kits.</li></ul><p><em>Note: The following was set up on Windows 10 for STM32 Nucleo F303K8. The Nucleo F030R8 was also tested and confirmed working with this setup.</em></p><h1 id=configuring-vs-code class=anchor><a href=#configuring-vs-code>Configuring VS Code</a></h1><p>Open the Debug panel (<code>CTRL + SHIFT + D</code>) and select &ldquo;Add Configuration > GDB&rdquo; through the top left dropdown arrow. Create a GDB configuration in launch.json and add the following. Note: Change the paths in &ldquo;target&rdquo;, &ldquo;gdbpath&rdquo;, and &ldquo;autorun&rdquo; to the correct locations.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;GDB&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;request&#34;</span><span class=p>:</span> <span class=s2>&#34;launch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;cwd&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}/.pioenvs/nucleo_f303k8/firmware.elf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;gdbpath&#34;</span> <span class=p>:</span> <span class=s2>&#34;C:/STM32Toolchain/gcc-arm/5.4 2016q3/bin/arm-none-eabi-gdb.exe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;autorun&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>   	<span class=s2>&#34;target remote localhost:3333&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   	<span class=s2>&#34;symbol-file ./.pioenvs/nucleo_f303k8/firmware.elf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   	<span class=s2>&#34;monitor reset&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class="row img-captioned"><a href=/posts/2017/10/vscode-debugger-setup/gdb.png><img loading=lazy class="img-responsive img-content" src=/posts/2017/10/vscode-debugger-setup/gdb.png></a><p class=caption>GDB debugger entry added after successfuly entry in launch.json file.</p></div></p><h1 id=starting-a-debug-session class=anchor><a href=#starting-a-debug-session>Starting a Debug Session</a></h1><p>Before entering debug mode (<code>F5</code>), you need to launch the OpenOCD server. Open Terminal in VS Code (<code>CTRL + ` </code>) and type:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openocd -f board\st_nucleo_f3.cfg
</span></span></code></pre></div><p><div class="row img-captioned"><a href=/posts/2017/10/vscode-debugger-setup/debugger.png><img loading=lazy class="img-responsive img-content" src=/posts/2017/10/vscode-debugger-setup/debugger.png></a><p class=caption>Adding breakpoints and stepping through code on an STM32 through VS Code!</p></div></p><p>Unfortunately you must always start the OpenOCD server before hitting <code>F5</code>, but fortunately you can just hit <code>Up</code> in the terminal to recall the last command.</p><h1 id=troubleshooting class=anchor><a href=#troubleshooting>Troubleshooting</a></h1><p>When running OpenOCD, the following error might come up:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Error: libusb_open() failed with LIBUSB_ERROR_NOT_SUPPORTED
</span></span></code></pre></div><p>Use Zadig to upgrade ST-Link Debug to the correct WinUSB driver. Enable through Options > List All</p><p><div class="row img-captioned"><a href=/posts/2017/10/vscode-debugger-setup/zadig.png><img loading=lazy class="img-responsive img-content" src=/posts/2017/10/vscode-debugger-setup/zadig.png></a><p class=caption>Fixing faulty USB drivers on Windows 10.</p></div></p><p>Happy debugging!</p></div><div class=nav-btn><a href=/>&lt; Recent Posts</a></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="justinmklam",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><div style=text-align:center><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>Comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>Comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script defer id=dsq-count-scr src=//justinmklam.disqus.com/count.js async></script></body><footer><div class=footer-container><hr><p>&copy; 2025 Justin Lam | <a href=/colophon>Colophon</a></p></div></footer></html>