<!doctype html><html lang=en><head><title>The Making of Project Haikuza: Part 1</title>
<meta property="og:image" content="https://justinmklam.com//imgs/blog-imgs/making-haikuza/8Y0EDX4VP9.jpg"><meta property="og:type" content="blog"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The development of a laughable haiku generator in Python."><meta name=author content="Justin Lam"><link rel=stylesheet href=/css/syntax.css media=screen><link rel=stylesheet href=/css/syntax-dark.css media="screen and (prefers-color-scheme: dark)"><link rel=stylesheet href=/css/neat.css><link rel=stylesheet href=/css/custom.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-85178257-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-85178257-1")</script></head><body><div class="navbar row"><div><span class=navbar-brand>Justin Lam</span></div><div class=navbar-links><a href=/>Blog</a>
<a href=/archives/>Archives</a>
<a href=/about/>About</a>
<a href=/contact/>Contact</a></div></div><div><div class=single-content><h2 data-toc-skip class=blog-title>The Making of Project Haikuza: Part 1</h2><p class=blog-title-metadata>Posted on July 12, 2015
&nbsp;&#183;&nbsp;7 min read
&nbsp;&#183;&nbsp;
<span class=disqus-comment-count data-disqus-url=https://justinmklam.com/posts/2015/making-haikuza-i/#disqus_thread>0 comments</span>
&nbsp;&#183;&nbsp;
<a class=blog-tag href=/tags/programming>#programming&nbsp;</a></p><a href=/imgs/blog-imgs/making-haikuza/8Y0EDX4VP9.jpg><img class="img-content img-content-header" src=/imgs/blog-imgs/making-haikuza/8Y0EDX4VP9.jpg></a><br><details class=toc><summary>&nbsp;Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#prequel-the-prudence-of-pivoting>Prequel: The Prudence of Pivoting</a></li><li><a href=#makin-bacon-haikus-v01>Makin Bacon Haikus V0.1</a><ul><li><a href=#haiku-training>Haiku Training</a></li><li><a href=#first-pass-haiku-generation>First Pass Haiku Generation</a></li></ul></li></ul></nav></summary></details><div class="blog-content page-content"><p><em>The format of this series is an outline of my thought process during the development of <a href=/projects/software/haikuza/>@thehaikuza</a>.</em></p><blockquote style=text-align:center>Haikus are simple<br>Even children can write them<br>maybe programs too?</blockquote><p>Nothing is cooler than algorithmic poetry. Except for maybe Carl Sagan. I heard he was a pretty cool guy.</p><p>I was listening to the radio while driving home one Sunday evening, and an ad came up for a university that was submitting computer-generated poetry to a literature competition. I&rsquo;ve recently been fascinated by the many intricacies of the English language, so the thought of somehow teaching a computer how to construct proper phrases seemed like an elusive task. But hey, if Google is also working on natural language processing, then how hard can it be?</p><p>The idea of computer generated text is often a humourous one. Spamming your smartphone&rsquo;s predictive keyboard is usually enough justification to avoid trying to computationally bang out the works of Shakespeare. As laughable as the monkeys at a typewriter idea is, maybe weve become smart enough to at least get close to this literary pipe dream&mldr;</p><h1 id=prequel-the-prudence-of-pivoting>Prequel: The Prudence of Pivoting</h1><p>Needless to say, it can take a few tries to end up at a decent idea, and @thehaikuza was no exception. After hearing about the poetry contest, I wanted to develop something related to computational linguistics, but I was partial to run-of-the-mill poetry. High school English classes had given me a negative bias for this type of literary art, so naturally I was in search for a different end product.</p><p>Rap songs were the first to come to mind. After all, songs are simply poems accompanied by musical harmonies and melodies, so I wasn&rsquo;t too far off from the realm of poetic computations. However, I eventually realized that writing rap songs from scratch (not to mention by an algorithm) would have mountains of difficulty, especially since my knowledge of natural language processing was currently at ground zero. I decided to scale back and start off small with the most simple form of poetry known to (probably) every North American student: the haiku.</p><p>Haikus are great because they are short in length and only have one simple rule: don&rsquo;t break the 5/7/5 syllable count per line. One of my coworkers suggested using Twitter as my platform for haiku generation, which would prove to be much easier than opening another can of worms of trying to develop my own web app. Since there&rsquo;s already a Twitter API library for Python, and with each average haiku being under the threshold of 140 characters, my decision was made before I even had to think about it.</p><p>With the advent of using Twitter, I had a few more options I could play with. My first idea was to make haikus based on the trending topics on Twitter. This would give my Twitter-bot the dynamic quality that&rsquo;s inherent in the fast-paced nature of the internet, rather than just creating stale haikus about nature. It could retrieve the trending topics, gather all the relevant tweets, and then use the collected phrases to formulate a relevant haiku. In theory, this seemed like a great idea; in practice, not so much! After some prototyping, I quickly learned that the broken English, frequent spelling mistakes, and chaotic nature of &lt; 140 character messages wouldnt serve as an adequate corpus for phrase generation.</p><p>Okay, well forget about that idea. But I still wanted a venue to stay relevant on the internet. I figured songs can also be relevant, especially if I would be grabbing ones that are currently playing on the radio. Adding an interactive element to @thehaikuza by making it able to respond to song requests would just be icing on the cake. Thus, @thehaikuza was born!</p><p>Or so I thought. Turned out it was still an embryo.</p><h1 id=makin-bacon-haikus-v01>Makin Bacon Haikus V0.1</h1><p>The first research topic on my ever-growing list was to figure out what makes a sensible sentence. In elementary school, we&rsquo;re taught that the most basic phrase consists of a subject and verb. In the sentence below, for example, the boy is the subject and is sweating is the action.</p><blockquote style=text-align:center>The boy is sweating.</blockquote><p>Okay, this evidently isnt new knowledge to anyone. But what if we break down the phrase into types of words? Referencing a universal <strong>part of speech (POS)</strong> tagging system, we get:</p><blockquote style=text-align:center>[The, determinant] [boy, noun] [is, verb] [sweating, verb]</blockquote><p>Interesting. Maybe I can create a Mad Lib-based language model that can learn the sentence structures of existing haikus, then use an external wordset to substitute the corresponding words. For poetry, and notably haikus, grammar isnt as important as a passive aggressive letter to your not-so-favourite mobile carrier, so I might be able to get away with this rudimentary language model. (Spoiler alert: I couldnt.)</p><h2 id=haiku-training>Haiku Training</h2><p>The plan was to create a pseudo-smart script (of sorts) that did the following:</p><ol><li>Import a collection of human-written haikus</li><li>Extract the POS tags for each line</li><li>Construct a database of 5 and 7 syllable POS phrases</li></ol><p>The implementation looked something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import nltk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class LearnHaiku(object):
</span></span><span class=line><span class=cl>    def __init__(self, fname):
</span></span><span class=line><span class=cl>        self.haikus = self.parse(fname)
</span></span><span class=line><span class=cl>        self.pos_five, self.pos_seven, self.log = self.analyze()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    @staticmethod
</span></span><span class=line><span class=cl>    def parse(fname):
</span></span><span class=line><span class=cl>        haikus = []
</span></span><span class=line><span class=cl>        with open(fname) as inputfile:
</span></span><span class=line><span class=cl>            for line in inputfile:
</span></span><span class=line><span class=cl>                haikus.append(line)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        return haikus
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    def analyze(self):
</span></span><span class=line><span class=cl>        line5s = []
</span></span><span class=line><span class=cl>        line7s = []
</span></span><span class=line><span class=cl>        errors = []
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        is_line7s = 1
</span></span><span class=line><span class=cl>        numrows = len(self.haikus)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        for i in range(numrows):
</span></span><span class=line><span class=cl>            &#34;&#34;&#34;Only parse if not a blank line&#34;&#34;&#34;
</span></span><span class=line><span class=cl>            if self.haikus[i] != &#39;\n&#39;:
</span></span><span class=line><span class=cl>                try:
</span></span><span class=line><span class=cl>                    tags = nltk.pos_tag(self.haikus[i].split(&#39; &#39;), tagset=&#39;universal&#39;)
</span></span><span class=line><span class=cl>                    if i == is_line7s:
</span></span><span class=line><span class=cl>                        line7s.append([x[1] for x in tags])
</span></span><span class=line><span class=cl>                        is_line7s += 4
</span></span><span class=line><span class=cl>                    else:
</span></span><span class=line><span class=cl>                        line5s.append([x[1] for x in tags])
</span></span><span class=line><span class=cl>                except UnicodeDecodeError:
</span></span><span class=line><span class=cl>                    errors.append(i+1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        log_str = &#34;Couldn&#39;t parse line(s) %s.&#34; %(&#39;, &#39;.join(str(x) for x in errors))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        return line5s, line7s, log_str
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if __name__ == &#39;__main__&#39;:
</span></span><span class=line><span class=cl>    hk = LearnHaiku(&#34;[REF] Haiku Training Examples V0.1.txt&#34;)
</span></span><span class=line><span class=cl>    print hk.pos_five
</span></span><span class=line><span class=cl>    print hk.pos_seven
</span></span></code></pre></div><p>From this, I could then randomly generate haiku POS templates that I would be able to use with an external set of words. From the (rather awfully juvenile) example haikus below:</p><blockquote style=text-align:center>An old silent pond<br>A frog jumps into the pond,<br>splash! Silence again.<br><br>The autumn moonlight<br>a large worm digs silently<br>into the chestnut.<br><br>Lightning flashes bright<br>what I thought were white faces<br>are plumes of plain grass.</blockquote><p>The POS tag retrieval for the phrases were:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Five Syllable Lines:
</span></span><span class=line><span class=cl>        [u&#39;DET&#39;, u&#39;ADJ&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;],
</span></span><span class=line><span class=cl>        [u&#39;NOUN&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;],
</span></span><span class=line><span class=cl>        [u&#39;DET&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;],
</span></span><span class=line><span class=cl>        [u&#39;NOUN&#39;, u&#39;VERB&#39;, u&#39;NOUN&#39;],
</span></span><span class=line><span class=cl>        [u&#39;VERB&#39;, u&#39;ADV&#39;, u&#39;ADP&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Seven Syllable Lines:
</span></span><span class=line><span class=cl>        [u&#39;DET&#39;, u&#39;NOUN&#39;, u&#39;VERB&#39;, u&#39;ADP&#39;, u&#39;DET&#39;, u&#39;ADJ&#39;],
</span></span><span class=line><span class=cl>        [u&#39;DET&#39;, u&#39;ADJ&#39;, u&#39;NOUN&#39;, u&#39;VERB&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;],
</span></span><span class=line><span class=cl>        [u&#39;PRON&#39;, u&#39;PRON&#39;, u&#39;VERB&#39;, u&#39;NOUN&#39;, u&#39;NOUN&#39;]
</span></span></code></pre></div><p>Almost there to our first haiku!</p><h2 id=first-pass-haiku-generation>First Pass Haiku Generation</h2><p>I wrote another simple script to take in song lyrics, apply a POS tag for each of the lyrics, and create a word list sorted by the corresponding tags. I could then plug-and-chug words from the generated list into an appropriate slot in the haiku template.</p><p>For the first test, I thought it was only appropriate to use lyrics from Drake&rsquo;s classic <em>Started From The Bottom</em>. The output:</p><blockquote style=text-align:center>Story screaming real<br>Out uncle own stay worry<br>Through bottom lips heard<br><br>When that standing as<br>Poppin coming we begging<br>From started keep if<br><br>Fucking ball standing<br>Niggas explaining guys crowd<br>Say girl chain rumors</blockquote><p>Oh dear lord, what a mellifluous balance of repulsive vocabulary and lackadaisical grammar. Those were definitely some of the worst haikus I&rsquo;ve read&mldr; Maybe if I try using <em>Blank Space</em> by Taylor Swift:</p><blockquote style=text-align:center>Half bottom boy flames<br>Feel what bottom you darling<br>crying was from is crying<br><br>Explaining queen lights<br>Stays leave could cherry stay<br>Town cause lets dress the<br><br>Crystal blank starts: flames<br>thats explaining funny hand<br>Cherry at god im</blockquote><p>I lied. Pretty sure those were worse.</p><p>Obviously, the generated haikus were complete word salad. With absolutely no concept of context or proper grammar, @thehaikuza V0.1 was light years away from reliably generating poems that made at least some remote level of sense. There was definitely more to constructing phrases than stuffing in random words into corresponding POS slots, so I needed another approach.</p><p>Hm, I keep hearing about this Markov Chain&mldr; I wonder if he&rsquo;s related to 2 Chainz?</p><p><em>Click here to read <a href=/posts/2015/making-haikuza-ii/>The Making of Project Haikuza: Part 2</a>!</em></p></div><div class=nav-btn><a href=/>&lt; Recent Posts</a></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="justinmklam",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><div style=text-align:center><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>Comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>Comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script defer id=dsq-count-scr src=//justinmklam.disqus.com/count.js async></script></body><footer><div class=footer-container><hr><p>&copy; 2025 Justin Lam | <a href=/colophon>Colophon</a></p></div></footer></html>